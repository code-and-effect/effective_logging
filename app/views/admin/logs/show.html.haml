%h2= @page_title

.panel{:class => "panel-#{bootstrap_class_for_status(@log.status)}"}
  .panel-heading
    - parents_of_log(@log).each do |log|
      = link_to(log.message, (@_effective_logging_active_admin ? admin_effective_log_path(log) : effective_logging.admin_log_path(log)))
      = ' > '
    %strong= @log.message
    .pull-right
      = link_to_if(@log.prev_log.present?, '< Prev', (@_effective_logging_active_admin ? admin_effective_log_path(@log.prev_log || 0) : effective_logging.admin_log_path(@log.prev_log || 0))) { 'Prev' }
      = ' - '
      = link_to_if(@log.next_log.present?, 'Next >', (@_effective_logging_active_admin ? admin_effective_log_path(@log.next_log || 0) : effective_logging.admin_log_path(@log.next_log || 0))) { 'Next' }

  .panel-body
    .row
      .col-lg-4
        %span.label{:class => "label-#{bootstrap_class_for_status(@log.status)}"}= @log.status
        &nbsp;
        = @log.created_at.strftime("%Y-%m-%d %H:%M:%S")
        = '(' + time_ago_in_words(@log.created_at) + ' ago)'

      .col-lg-4
        - if @log.user.present?
          %strong User:
          &nbsp;
          = (@log.user.to_s.starts_with?('#<User:0x') ? (@log.user.email rescue @log.user) : @log.user)
          - links = [effective_logging_object_link_to(@log.user, :show), effective_logging_object_link_to(@log.user, :edit)].compact
          - if links.present?
            = "(#{links.join(' - ')})".html_safe
      .col-lg-4
        - if @log.associated.present?
          %strong Regarding:
          &nbsp;
          - if @log.associated.to_s.starts_with?('#<')
            = "#{@log.associated.class.name} ##{@log.associated.to_param}"
          - else
            = @log.associated

    - @log.details.each do |key, value|
      - next unless value.present?
      .row
        .col-lg-12
          %br
          %p
            %strong= "#{key.to_s.titleize}:"
          - if value.kind_of?(Hash)
            = tableize_hash(value, :class => 'table', :style => 'width: 50%', :th => true)
          - else
            = simple_format(value.to_s)

    - if @log.logs.present?
      .row
        .col-lg-12
          %br
          %p
            %strong Additional Entries:
            = "this log contains #{@log.logs_count} additional sub entries"
      %hr
      .row
        .col-lg-12= render_datatable @datatable

